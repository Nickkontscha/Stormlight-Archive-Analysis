"0","# Count the frequency of the relevant characters in each book"
"0","chars <- AllBooks %>% "
"0","  select(character, flashback, book) %>% "
"0","  group_by(character, book) %>% "
"0","  count(flashback) %>% "
"0","  ungroup() %>% "
"0","  arrange(flashback, desc(n)) %>% "
"0","  filter(character %in% relChars)"
"0","# Fix the order in the plot "
"0","chars$character <- factor(chars$character, levels = rev(relChars))"
"0","# Plot"
"0","charPlot <- ggplot(chars, aes( x = character, y = n, fill = flashback)) +"
"0","  geom_bar(stat = ""identity"", position = position_stack(reverse = TRUE)) +"
"0","  facet_wrap(~book) +"
"0","  theme(panel.background = element_rect(fill = ""#ecf0f1"")) + "
"0","  scale_fill_manual(values = swatch()[c(7,2)]) +"
"0","  ggtitle(""Number of Chapters of Each Character Ordered by Books"") +"
"0","  labs(x = NULL,"
"0","       y = ""Number of chapters"","
"0","       fill = ""Flashback"") + "
"0","  coord_flip()"
"0","charPlot"
